"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[103],{2103:(P,m,c)=>{c.r(m),c.d(m,{CheckoutModule:()=>G});var a=c(6895),p=c(6949),e=c(1571);function g(o,l){if(1&o&&(e.TgZ(0,"button",5),e._uU(1," View your order "),e.qZA()),2&o){const t=e.oxw();e.MGl("routerLink","/orders/",t.order.id,"")}}function b(o,l){1&o&&(e.TgZ(0,"button",6),e._uU(1," View your orders "),e.qZA())}let Z=(()=>{class o{constructor(t){this.router=t;const r=this.router.getCurrentNavigation();this.order=r?.extras?.state}static#e=this.\u0275fac=function(r){return new(r||o)(e.Y36(p.F0))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-checkout-success"]],decls:9,vars:2,consts:[[1,"container","mt-5"],[1,"fa","fa-check-circle","fa-5x",2,"color","green"],[1,"mb-4"],["class","btn btn-outline-success",3,"routerLink",4,"ngIf"],["routerLink","/orders","class","btn btn-outline-success",4,"ngIf"],[1,"btn","btn-outline-success",3,"routerLink"],["routerLink","/orders",1,"btn","btn-outline-success"]],template:function(r,s){1&r&&(e.TgZ(0,"div",0)(1,"div"),e._UZ(2,"i",1),e.qZA(),e.TgZ(3,"h2"),e._uU(4,"Thank you. Your order is confirmed"),e.qZA(),e.TgZ(5,"p",2),e._uU(6,"Your order has not shipped yet, but this is to be expected as we are not a real store!"),e.qZA(),e.YNc(7,g,2,1,"button",3),e.YNc(8,b,2,0,"button",4),e.qZA()),2&r&&(e.xp6(7),e.Q6J("ngIf",s.order),e.xp6(1),e.Q6J("ngIf",!s.order))},dependencies:[a.O5,p.rH]})}return o})();var n=c(433),h=c(9479),x=c(5053),u=c(6875);function y(o,l){if(1&o){const t=e.EpF();e.TgZ(0,"li",4)(1,"div",5)(2,"button",6),e.NdJ("click",function(){const i=e.CHM(t).index,d=e.oxw();return e.KtG(d.onClick(i))}),e._uU(3),e.qZA()()()}if(2&o){const t=l.$implicit,r=l.index,s=e.oxw();e.xp6(2),e.ekj("active",s.selectedIndex===r),e.xp6(1),e.AsE(" ",t.label,":",t.completed," ")}}function C(o,l){if(1&o&&(e.TgZ(0,"div"),e.GkF(1,7),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngTemplateOutlet",t.selected.content)}}let F=(()=>{class o extends u.B8{constructor(){super(...arguments),this.linearModeSelected=!0}ngOnInit(){this.linear=this.linearModeSelected}onClick(t){this.selectedIndex=t}static#e=this.\u0275fac=function(){let t;return function(s){return(t||(t=e.n5z(o)))(s||o)}}();static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-stepper"]],inputs:{linearModeSelected:"linearModeSelected"},features:[e._Bn([{provide:u.B8,useExisting:o}]),e.qOj],decls:4,vars:2,consts:[[1,"container"],[1,"nav","nav-pills","nav-justified"],["class","nav-item",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"nav-item"],[1,"d-grid"],[1,"nav-link","py-3","text-uppercase","fw-bold",3,"click"],[3,"ngTemplateOutlet"]],template:function(r,s){1&r&&(e.TgZ(0,"div",0)(1,"ul",1),e.YNc(2,y,4,4,"li",2),e.qZA(),e.YNc(3,C,2,1,"div",3),e.qZA()),2&r&&(e.xp6(2),e.Q6J("ngForOf",s.steps),e.xp6(1),e.Q6J("ngIf",s.selected))},dependencies:[a.sg,a.O5,a.tP],styles:["button.nav-link[_ngcontent-%COMP%]{background:#e9ecef;border-radius:0;border:none;color:#333}"]})}return o})();var f=c(7185),_=c(4015);function T(o,l){if(1&o){const t=e.EpF();e.TgZ(0,"div",6)(1,"div",7)(2,"h4"),e._uU(3,"Shipping address"),e.qZA(),e.TgZ(4,"button",8),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.saveUserAddress())}),e._uU(5," Save as default address "),e.qZA()(),e.TgZ(6,"div",9)(7,"div",10),e._UZ(8,"app-text-input",11),e.qZA(),e.TgZ(9,"div",10),e._UZ(10,"app-text-input",12),e.qZA(),e.TgZ(11,"div",10),e._UZ(12,"app-text-input",13),e.qZA(),e.TgZ(13,"div",10),e._UZ(14,"app-text-input",14),e.qZA(),e.TgZ(15,"div",10),e._UZ(16,"app-text-input",15),e.qZA(),e.TgZ(17,"div",10),e._UZ(18,"app-text-input",16),e.qZA()()()}if(2&o){const t=e.oxw();let r;e.Q6J("formGroup",t.checkoutForm),e.xp6(4),e.Q6J("disabled",!(null!=(r=t.checkoutForm.get("addressForm"))&&r.valid&&null!=(r=t.checkoutForm.get("addressForm"))&&r.dirty)),e.xp6(4),e.Q6J("label","First name"),e.xp6(2),e.Q6J("label","Last name"),e.xp6(2),e.Q6J("label","Street"),e.xp6(2),e.Q6J("label","City"),e.xp6(2),e.Q6J("label","State"),e.xp6(2),e.Q6J("label","Zip code")}}let A=(()=>{class o{constructor(t,r){this.accountService=t,this.toastr=r}saveUserAddress(){this.accountService.updateUserAddress(this.checkoutForm?.get("addressForm")?.value).subscribe({next:()=>{this.toastr.success("Address saved"),this.checkoutForm?.get("addressForm")?.reset(this.checkoutForm?.get("addressForm")?.value)}})}static#e=this.\u0275fac=function(r){return new(r||o)(e.Y36(h.B),e.Y36(f._W))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-checkout-address"]],inputs:{checkoutForm:"checkoutForm"},decls:8,vars:1,consts:[["class","mt-4",3,"formGroup",4,"ngIf"],[1,"d-flex","justify-content-between","flex-row","mb-5"],["routerLink","/basket",1,"btn","btn-outline-primary"],[1,"fa","fa-angle-left"],["cdkStepperNext","",1,"btn","btn-primary"],[1,"fa","fa-angle-right"],[1,"mt-4",3,"formGroup"],[1,"d-flex","justify-content-between","align-items-center"],[1,"btn","btn-outline-success","mb-3",3,"disabled","click"],["formGroupName","addressForm",1,"row"],[1,"form-group","col-6"],["formControlName","firstName",3,"label"],["formControlName","lastName",3,"label"],["formControlName","street",3,"label"],["formControlName","city",3,"label"],["formControlName","state",3,"label"],["formControlName","zipcode",3,"label"]],template:function(r,s){1&r&&(e.YNc(0,T,19,8,"div",0),e.TgZ(1,"div",1)(2,"button",2),e._UZ(3,"i",3),e._uU(4," Back to basket "),e.qZA(),e.TgZ(5,"button",4),e._uU(6," Go to Delivery "),e._UZ(7,"i",5),e.qZA()()),2&r&&e.Q6J("ngIf",s.checkoutForm)},dependencies:[a.O5,p.rH,n.JJ,n.JL,n.sg,n.u,n.x0,_.t,u.st]})}return o})();var U=c(4004),S=c(2340),J=c(529);let v=(()=>{class o{constructor(t){this.http=t,this.baseUrl=S.N.apiUrl}createOrder(t){return this.http.post(this.baseUrl+"orders",t)}getDeliveryMethods(){return this.http.get(this.baseUrl+"orders/deliveryMethods").pipe((0,U.U)(t=>t.sort((r,s)=>s.price-r.price)))}static#e=this.\u0275fac=function(r){return new(r||o)(e.LFG(J.eN))};static#t=this.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var k=c(5866);function q(o,l){if(1&o){const t=e.EpF();e.TgZ(0,"div",9)(1,"input",10),e.NdJ("click",function(){const i=e.CHM(t).$implicit,d=e.oxw(2);return e.KtG(d.setShippingPrice(i))}),e.qZA(),e.TgZ(2,"label",11)(3,"strong"),e._uU(4),e.ALo(5,"currency"),e.qZA(),e._UZ(6,"br"),e.TgZ(7,"span",12),e._uU(8),e.qZA()()()}if(2&o){const t=l.$implicit;e.xp6(1),e.s9C("id",t.id),e.s9C("value",t.id),e.xp6(1),e.s9C("for",t.id),e.xp6(2),e.AsE("",t.shortName," - ",e.lcZ(5,6,t.price),""),e.xp6(4),e.Oqu(t.description)}}function N(o,l){if(1&o&&(e.TgZ(0,"div",6)(1,"div",7),e.YNc(2,q,9,8,"div",8),e.qZA()()),2&o){const t=e.oxw();e.Q6J("formGroup",t.checkoutForm),e.xp6(2),e.Q6J("ngForOf",t.deliveryMethods)}}let w=(()=>{class o{constructor(t,r){this.checkoutService=t,this.basketService=r,this.deliveryMethods=[]}ngOnInit(){this.checkoutService.getDeliveryMethods().subscribe({next:t=>this.deliveryMethods=t})}setShippingPrice(t){this.basketService.setShippingPrice(t)}static#e=this.\u0275fac=function(r){return new(r||o)(e.Y36(v),e.Y36(k.v))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-checkout-delivery"]],inputs:{checkoutForm:"checkoutForm"},decls:8,vars:1,consts:[["class","mt-4",3,"formGroup",4,"ngIf"],[1,"d-flex","justify-content-between","flex-row","mb-5"],["cdkStepperPrevious","",1,"btn","btn-outline-primary"],[1,"fa","fa-angle-left"],["cdkStepperNext","",1,"btn","btn-primary"],[1,"fa","fa-angle-right"],[1,"mt-4",3,"formGroup"],["formGroupName","deliveryForm",1,"row"],["class","col-6 form-group",4,"ngFor","ngForOf"],[1,"col-6","form-group"],["type","radio","formControlName","deliveryMethod",1,"form-check-input",3,"id","value","click"],[1,"form-check-label","ms-2","mb-3",3,"for"],[1,"label-description"]],template:function(r,s){1&r&&(e.YNc(0,N,3,2,"div",0),e.TgZ(1,"div",1)(2,"button",2),e._UZ(3,"i",3),e._uU(4," Back to address "),e.qZA(),e.TgZ(5,"button",4),e._uU(6," Go to Review "),e._UZ(7,"i",5),e.qZA()()),2&r&&e.Q6J("ngIf",s.checkoutForm)},dependencies:[a.sg,a.O5,n.Fj,n._,n.JJ,n.JL,n.sg,n.u,n.x0,u.st,u.po,a.H9]})}return o})();var I=c(8795);let Q=(()=>{class o{static#e=this.\u0275fac=function(r){return new(r||o)};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-checkout-review"]],decls:9,vars:1,consts:[[1,"mt-4"],[3,"isBasket"],[1,"d-flex","justify-content-between","flex-row","mb-5"],["cdkStepperPrevious","",1,"btn","btn-outline-primary"],[1,"fa","fa-angle-left"],["cdkStepperNext","",1,"btn","btn-primary"],[1,"fa","fa-angle-right"]],template:function(r,s){1&r&&(e.TgZ(0,"div",0),e._UZ(1,"app-basket-summary",1),e.qZA(),e.TgZ(2,"div",2)(3,"button",3),e._UZ(4,"i",4),e._uU(5," Back to delivery "),e.qZA(),e.TgZ(6,"button",5),e._uU(7," Go to Payment "),e._UZ(8,"i",6),e.qZA()()),2&r&&(e.xp6(1),e.Q6J("isBasket",!1))},dependencies:[u.st,u.po,I.b]})}return o})(),M=(()=>{class o{constructor(t,r,s,i){this.basketService=t,this.checkoutService=r,this.toastr=s,this.router=i}submitOrder(){const t=this.basketService.getCurrentBasketValue();if(!t)return;const r=this.getOrderToCreate(t);r&&this.checkoutService.createOrder(r).subscribe({next:s=>{this.toastr.success("Order created successfully"),this.basketService.deleteLocalBasket(),this.router.navigate(["checkout/success"],{state:s})}})}getOrderToCreate(t){const r=this.checkoutForm?.get("deliveryForm")?.get("deliveryMethod")?.value,s=this.checkoutForm?.get("addressForm")?.value;if(r&&s)return{basketId:t.id,deliveryMethodId:r,shipToAddress:s}}static#e=this.\u0275fac=function(r){return new(r||o)(e.Y36(k.v),e.Y36(v),e.Y36(f._W),e.Y36(p.F0))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-checkout-payment"]],inputs:{checkoutForm:"checkoutForm"},decls:9,vars:0,consts:[[1,"d-flex","justify-content-between","flex-row","mb-5"],["cdkStepperPrevious","",1,"btn","btn-outline-primary"],[1,"fa","fa-angle-left"],[1,"btn","btn-primary",3,"click"],[1,"fa","fa-angle-right"]],template:function(r,s){1&r&&(e.TgZ(0,"p"),e._uU(1,"checkout-payment works!"),e.qZA(),e.TgZ(2,"div",0)(3,"button",1),e._UZ(4,"i",2),e._uU(5," Back to review "),e.qZA(),e.TgZ(6,"button",3),e.NdJ("click",function(){return s.submitOrder()}),e._uU(7," Submit order "),e._UZ(8,"i",4),e.qZA()())},dependencies:[u.po]})}return o})();const O=[{path:"",component:(()=>{class o{constructor(t,r){this.fb=t,this.accountService=r,this.checkoutForm=this.fb.group({addressForm:this.fb.group({firstName:["",n.kI.required],lastName:["",n.kI.required],street:["",n.kI.required],city:["",n.kI.required],state:["",n.kI.required],zipcode:["",n.kI.required]}),deliveryForm:this.fb.group({deliveryMethod:["",n.kI.required]}),paymentForm:this.fb.group({nameOnCard:["",n.kI.required]})})}ngOnInit(){this.getAddressFormValues()}getAddressFormValues(){this.accountService.getUserAddress().subscribe({next:t=>{t&&this.checkoutForm.get("addressForm")?.patchValue(t)}})}static#e=this.\u0275fac=function(r){return new(r||o)(e.Y36(n.qu),e.Y36(h.B))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-checkout"]],decls:15,vars:10,consts:[[1,"container","mt-5"],[1,"row"],[1,"col-8"],[3,"linearModeSelected"],["appStepper",""],[3,"label","completed"],[3,"checkoutForm"],[3,"label"],[1,"col-4"]],template:function(r,s){if(1&r&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"app-stepper",3,4)(5,"cdk-step",5),e._UZ(6,"app-checkout-address",6),e.qZA(),e.TgZ(7,"cdk-step",5),e._UZ(8,"app-checkout-delivery",6),e.qZA(),e.TgZ(9,"cdk-step",7),e._UZ(10,"app-checkout-review"),e.qZA(),e.TgZ(11,"cdk-step",7),e._UZ(12,"app-checkout-payment",6),e.qZA()()(),e.TgZ(13,"div",8),e._UZ(14,"app-order-totals"),e.qZA()()()),2&r){let i,d;e.xp6(3),e.Q6J("linearModeSelected",!1),e.xp6(2),e.Q6J("label","Address")("completed",null==(i=s.checkoutForm.get("addressForm"))?null:i.valid),e.xp6(1),e.Q6J("checkoutForm",s.checkoutForm),e.xp6(1),e.Q6J("label","Delivery")("completed",null==(d=s.checkoutForm.get("deliveryForm"))?null:d.valid),e.xp6(1),e.Q6J("checkoutForm",s.checkoutForm),e.xp6(1),e.Q6J("label","Review"),e.xp6(2),e.Q6J("label","Payment"),e.xp6(1),e.Q6J("checkoutForm",s.checkoutForm)}},dependencies:[x.S,F,u.be,A,w,Q,M]})}return o})()},{path:"success",component:Z}];let Y=(()=>{class o{static#e=this.\u0275fac=function(r){return new(r||o)};static#t=this.\u0275mod=e.oAB({type:o});static#o=this.\u0275inj=e.cJS({imports:[p.Bz.forChild(O),p.Bz]})}return o})();var B=c(4466);let G=(()=>{class o{static#e=this.\u0275fac=function(r){return new(r||o)};static#t=this.\u0275mod=e.oAB({type:o});static#o=this.\u0275inj=e.cJS({imports:[a.ez,Y,B.m]})}return o})()}}]);